---
output: github_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Final Project DS202
## Marissa Baietto, Ryan Dorle, Braeden Collings
Importing the accident datasets.
```{r}
library(readr)
accident_2017 <- read_csv("2017.csv")
accident_2018 <- read_csv("2018.csv")
accident_2019 <- read_csv("2019.csv")
accident_2020 <- read_csv("2020.csv")
accident_2021 <- read_csv("2021.csv")
```

```{r}
library(tidyverse)
```

Selecting the variables we need.
```{r}
accident_2017 <- accident_2017 %>% select(STATENAME, ST_CASE, PERNOTMVIT, VE_FORMS, PVH_INVL, PERMVIT, COUNTY, CITY, MONTH, DAY, YEAR, HOUR, MINUTE, RUR_URBNAME, LATITUDE, LONGITUD, HARM_EVNAME, MAN_COLLNAME, RELJCT2NAME, WRK_ZONENAME, LGT_CONDNAME, WEATHER1NAME, SCH_BUSNAME, FATALS, DRUNK_DR)
accident_2018 <- accident_2018 %>% select(STATENAME, ST_CASE, PERNOTMVIT, VE_FORMS, PVH_INVL, PERMVIT, COUNTY, CITY, MONTH, DAY, YEAR, HOUR, MINUTE, RUR_URBNAME, LATITUDE, LONGITUD, HARM_EVNAME, MAN_COLLNAME, RELJCT2NAME, WRK_ZONENAME, LGT_CONDNAME, WEATHER1NAME, SCH_BUSNAME, FATALS, DRUNK_DR)
accident_2019 <- accident_2019 %>% select(STATENAME, ST_CASE, PERNOTMVIT, VE_FORMS, PVH_INVL, PERMVIT, COUNTY, CITY, MONTH, DAY, YEAR, HOUR, MINUTE, RUR_URBNAME, LATITUDE, LONGITUD, HARM_EVNAME, MAN_COLLNAME, RELJCT2NAME, WRK_ZONENAME, LGT_CONDNAME, WEATHER1NAME, SCH_BUSNAME, FATALS, DRUNK_DR)
accident_2020 <- accident_2020 %>% select(STATENAME, ST_CASE, PERNOTMVIT, VE_FORMS, PVH_INVL, PERMVIT, COUNTY, CITY, MONTH, DAY, YEAR, HOUR, MINUTE, RUR_URBNAME, LATITUDE, LONGITUD, HARM_EVNAME, MAN_COLLNAME, RELJCT2NAME, WRK_ZONENAME, LGT_CONDNAME, WEATHERNAME, SCH_BUSNAME, FATALS, DRUNK_DR)
accident_2021 <- accident_2021 %>% select(STATENAME, ST_CASE, PERNOTMVIT, VE_FORMS, PVH_INVL, PERMVIT, COUNTY, CITY, MONTH, DAY, YEAR, HOUR, MINUTE, RUR_URBNAME, LATITUDE, LONGITUD, HARM_EVNAME, MAN_COLLNAME, RELJCT2NAME, WRK_ZONENAME, LGT_CONDNAME, WEATHERNAME, SCH_BUSNAME, FATALS)
```

Importing the person datasets.
```{r}
person_2017 <- read_csv("2017_person.csv")
person_2018 <- read_csv("2018_person.csv")
person_2019 <- read_csv("2019_person.csv")
person_2020 <- read_csv("2020_person.csv")
person_2021 <- read_csv("2021_person.csv")
```

Adding year variable to the datasets.
```{r}
person_2017$YEAR = 2017
person_2018$YEAR = 2018
person_2019$YEAR = 2019
person_2020$YEAR = 2020
person_2021$YEAR = 2021
```


Merging the datasets.
```{r}
df_2017 <- left_join(accident_2017, person_2017, by=c('YEAR', 'ST_CASE'))
df_2018 <- left_join(accident_2018, person_2018, by=c('YEAR', 'ST_CASE'))
df_2019 <- left_join(accident_2019, person_2019, by=c('YEAR', 'ST_CASE'))
df_2020 <- left_join(accident_2020, person_2020, by=c('YEAR', 'ST_CASE'))
df_2021 <- left_join(accident_2021, person_2021, by=c('YEAR', 'ST_CASE'))
```

Creating one dataset with all years.
```{r}
df <- bind_rows(df_2017, df_2018,df_2019,df_2020,df_2021)
df1 <- df %>% group_by(STATENAME, YEAR) %>% filter(ST_CASE %% 10000 <= 200)
```

Saving the final dataset to 'master.csv'

```{r}
write.csv(df1, 'master.csv')
```

## Discription of Data
The data we chose to work with is from the National Highway Traffic Safety Administration. The administration has a system called FARS or the Fatality Analysis Reporting System in which vehicle crashes are noted. The data is comprised from police reports, death certificates, various medical reports, and department data. We chose to look at the years from 2017-2021 for our report. 
```{r}
summary(df1)
```

## Marginal Summaries
* STATENAME: The state the fatal crash occured in
* WEATHERNAME: The type of weather outside at the time and location of the crash.
* VEH_NO: Vehicle Number, a number assigned to each vehicle in the crash.
* PER_NO: Person Number, A unique number assigned to any person involved in the crash.
* WORK_INJNAME: Fatal injury at work, whether the person was at work at the time of the crash.
* LAG_HRSNAME: Lag Time, hours between the crash and the time of death.
* DOANAME:
* DRUGSNAME:
* DRINKINGNAME:      
* EJECTIONNAME:
* REST_USENAME:
* INJ_SEVNAME:
* SEXNAME:
* AGE:
* DRUNK_DR: Drinking Drivers, The number of drinking drivers involved in the crash.
* FATALS:
* SCH_BUSNAME:
* WEATHER1NAME:
* LGT_CONDNAME:
* WRK_ZONENAME:      
* RELJCT2NAME:       
* MAN_COLLNAME:
* HARM_EVNAME:
* LATITUDE: The location of the crash using global positioning (East and West).
* LONGITUD: The location of the crash using global positioning (North and South).
* RUR_URBNAME: Land Use, the segment of the traffic way on which the crash occurred based on urbanized areas.
* HOUR: The time of the crash in hours.
* MINUTE: The time of the crash in minutes.
* CITY: The location of the crash.
* MONTH: The month the crash occurred in.
* DAY: The day the crash occurred on.
* YEAR: The year in which the crash happened. 
* COUNTY: The county in which the crash occured in.
* PERMVIT:
* PVH_INVL:
* VE_FORMS:
* PERNOTMVIT:
* ST_CASE: Unique case number assigned to each crash.


